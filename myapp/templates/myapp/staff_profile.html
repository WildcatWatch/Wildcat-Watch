{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Staff Profile | Wildcat Watch</title>

  <link rel="stylesheet" href="{% static 'wildcatwatch/css/admin_dashboard.css' %}">
  <link rel="stylesheet" href="{% static 'wildcatwatch/css/admin_profile.css' %}">
</head>
<body data-staff-id="{{ staff.id }}">

  <!-- ===== Header ===== -->
  <header class="header">
    <div class="header-container">
      <div class="logo">
        <div class="shield-icon">üõ°Ô∏è</div> 
        <h1>Wildcat Watch</h1>
      </div>
      <nav class="nav">
        <a href="{% url 'staff_dashboard' %}">Dashboard</a>
        <a href="{% url 'my_duties' %}">My Duties</a>
        <a href="{% url 'attendance_dashboard' %}">Attendance</a>
      </nav>
      <div class="header-actions">
        <a href="{% url 'staff_profile' %}" class="profile-icon">üë§</a>
        <a href="{% url 'notifications_list' %}" class="notification-icon">üîî</a>
        <a href="{% url 'logout' %}" class="logout-btn">Logout</a>
      </div>
    </div>
  </header>

  <!-- ===== Main Content ===== -->
  <main class="main-content">
    <div class="container">
      <div class="profile-card">
        <h2>My Profile</h2>

        <!-- ====================== DISPLAY MODE ====================== -->
        <div id="profile-display">
          <div class="info-grid">
            <div class="info-item">
              <label>Full Name</label>
              <p id="display-fullname-text">{{ profile.fullname|default:"Not Set" }}</p>
            </div>
            <div class="info-item">
              <label>Date of Birth</label>
              <p id="display-dob-text">{{ profile.dob|date:"F d, Y"|default:"Not Set" }}</p>
            </div>
            <div class="info-item">
              <label>Age</label>
              <p id="display-age-text">{{ profile.age|default:"Not Set" }}</p>
            </div>
            <div class="info-item">
              <label>Gender</label>
              <p id="display-gender-text">{{ profile.gender|default:"Not Set" }}</p>
            </div>
             <div class="info-item">
              <label>User ID</label>
              <p id="display-userid-text">{{ request.user.id_number }}</p>
            </div>
            <div class="info-item">
              <label>Email</label>
              <p id="display-email-text">{{ request.user.email }}</p>
            </div>
            
            <div class="info-item">
              <label>Phone</label>
              <p id="display-phone-text">{{ profile.phone|default:"Not Set" }}</p>
            </div>
            <div class="info-item">
              <label>Emergency Contact</label>
              <p id="display-emergency_contact-text">{{ profile.emergency_contact|default:"Not Set" }}</p>
            </div>
            <div class="info-item full-width">
              <label>Address</label>
              <p id="display-address-text">{{ profile.address|default:"Not Set" }}</p>
            </div>
            
            
            
          </div>

          <div style="text-align:center; margin-top: 2rem;">
            <button class="edit-btn" onclick="toggleEdit()">Edit Profile</button>
          </div>
        </div>

        <!-- ====================== EDIT MODE ====================== -->
        <form id="profile-form" class="edit-form" method="POST">
          {% csrf_token %}
          <div class="info-grid">
            <div class="info-item">
              <label>Full Name</label>
              <input type="text" name="fullname" value="{{ profile.fullname|default:'' }}">
            </div>
            <div class="info-item">
              <label>Date of Birth</label>
              <input type="date" name="dob" value="{{ profile.dob|date:'Y-m-d' }}">
            </div>
            <div class="info-item">
              <label>Age</label>
              <input type="number" name="age" value="{{ profile.age|default:'' }}" readonly>
            </div>
            <div class="info-item">
              <label>Gender</label>
              <select name="gender">
                <option value="">-- Select --</option>
                <option value="Male" {% if profile.gender == "Male" %}selected{% endif %}>Male</option>
                <option value="Female" {% if profile.gender == "Female" %}selected{% endif %}>Female</option>
                <option value="Other" {% if profile.gender == "Other" %}selected{% endif %}>Other</option>
              </select>
            </div>
            <div class="info-item">
             <label>User ID</label>
             <input type="text" value="{{ request.user.id_number }}" readonly>
            </div>

            <div class="info-item">
              <label>Email</label>
              <input type="email" name="email" value="{{ request.user.email }}">
            </div>
            
            <div class="info-item">
              <label>Phone</label>
              <input type="text" name="phone" value="{{ profile.phone|default:'' }}" maxlength="11" pattern="[0-9]{11}">
            </div>
            <div class="info-item">
              <label>Emergency Contact</label>
              <input type="text" name="emergency_contact" value="{{ profile.emergency_contact|default:'' }}" maxlength="11" pattern="[0-9]{11}">
            </div>
            <div class="info-item full-width">
              <label>Address</label>
              <input type="text" name="address" value="{{ profile.address|default:'' }}">
            </div>
            
            
          </div>

          <div class="form-actions">
            <button type="submit" class="save-btn">Save Changes</button>
            <button type="button" class="cancel-btn" onclick="toggleEdit()">Cancel</button>
          </div>
        </form>
      </div>
    </div>
  </main>

  <!-- Pass URL to JS -->
  <script>
    const updateProfileUrl = "{% url 'update_staff_profile' %}";
  </script>
  <script src="{% static 'wildcatwatch/js/staff_profile.js' %}"></script>
</body>
</html>
